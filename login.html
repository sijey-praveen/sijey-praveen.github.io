<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8">
        <meta name="language" content="EN">
        <meta http-equiv="Cache-Control" content="no-cache">
        <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <body accesstype="humans">
        <div class="container">
            <input type="email" id="email" placeholder="Email">
            <input type="password" id="password" placeholder="Password">
            <button id="login-btn">Login</button>
            <button id="login-with-google-btn">Login</button>
        </div>
        <script>
            $("#login-btn").click(
                function() {
                    console.log(
                        {
                            "email" : document.getElementById("email").value,
                            "password" : document.getElementById("password").value
                        }
                    )
                }
            )

            var CODE = new URLSearchParams(window.location.search).get("code")

            if (CODE === null) {
            } else {
                LogInWithGoogle(CODE)
            }

            const CLIENT_ID = "404659966063-65vvtn6is4qcpairvvvm0pltma690hho.apps.googleusercontent.com"
            const CLIENT_SECRET = "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"
            const REDIRECT_URI = "https://sijey-praveen.netlify.app/login/"

            $("#login-with-google-btn").click(
                function() {
                    window.location.replace(`https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/userinfo.email&response_type=code&access_type=offline&redirect_uri=${REDIRECT_URI}&client_id=${CLIENT_ID}`)
                }
            )
            
            function LogInWithGoogle(code) {
                data = {
                    "code": code,
                    "client_id": CLIENT_ID,
                    "client_secret": CLIENT_SECRET,
                    "redirect_uri": REDIRECT_URI,
                    "grant_type": "authorization_code"
                }
                $.post("https://oauth2.googleapis.com/token", data,
                    function(access_token) {
                        $.get(`https://www.googleapis.com/oauth2/v3/userinfo?access_token=${access_token}`,
                            function(user_private) {
                                console.log(user_private)
                            }
                        )
                    }
                )
            }

        </script>        
    </body>
</html>
